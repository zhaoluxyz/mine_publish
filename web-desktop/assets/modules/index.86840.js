System.register("chunks:///_virtual/common_item_view.ts",["./rollupPluginModLoBabelHelpers.js","cc","./game_event.ts","./util.ts","./global_functions.ts","./notifier_center.ts","./GameData.ts"],(function(t){"use strict";var e,i,n,o,r,c,s,u,a,l,m,p,f,d,I,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,c=t._decorator,s=t.Label,u=t.Node,a=t.UITransform,l=t.Vec3,m=t.Component},function(t){p=t.GameEventType},function(t){f=t.Util},function(t){d=t.GF},function(t){I=t.Notifier},function(t){h=t.GD}],execute:function(){var g,b,v,_,y,N;r._RF.push({},"49c71TgJodELKFry8m5oJBV","common_item_view",void 0);var U=c.ccclass,D=c.property;t("CommonItemView",(g=D(s),b=D(u),U((y=e((_=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),c=0;c<i;c++)r[c]=arguments[c];return e=t.call.apply(t,[this].concat(r))||this,n(e,"lblNum",y,o(e)),n(e,"sprItem",N,o(e)),e.clickBtn=void 0,e.itemId=0,e}i(e,t);var r=e.prototype;return r.onLoad=function(){I.listen(p.GAME_DATA_USER,this.onUpdateNum,this)},r.initParams=function(t){t&&t.itemId&&(this.itemId=t.itemId),this.initUI()},r.initUI=function(){d.setTexture(this.sprItem,d.getLocalItemPath(this.itemId)),this.onUpdateNum()},r.onUpdateNum=function(){if(this.itemId){var t,e=this.itemId;t=h.bag.getItemCount(e),this.lblNum.string=f.formatNumber(t,1e4)}},r.getIconNode=function(){return this.sprItem},r.getIconWorldPos=function(){return this.sprItem.getComponent(a).convertToWorldSpaceAR(l.ZERO)},r.onClickDetail=function(){},e}(m)).prototype,"lblNum",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=e(_.prototype,"sprItem",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=_))||v));r._RF.pop()}}}));

System.register("chunks:///_virtual/gamedata_mine.ts",["./rollupPluginModLoBabelHelpers.js","cc","./LocalConfig.ts","./ConfigLoader.ts","./GameObject.ts","./GameData.ts","./game_event.ts","./message_manager.ts","./notifier_center.ts","./server_time.ts","./mine_const.ts"],(function(e){"use strict";var t,i,n,o,a,r,s,u,c,g,f,d;return{setters:[function(e){t=e.createClass},function(e){i=e.cclegacy},function(e){n=e.LocalConfig},function(e){o=e.ConfigPath},function(e){a=e.register_handler},function(e){r=e.GD},function(e){s=e.GameEventType},function(e){u=e.MessageManager,c=e.ClientProtocols},function(e){g=e.Notifier},function(e){f=e.ServerTime},function(e){d=e.MineConst}],execute:function(){i._RF.push({},"5153fC/3VJDzJfNETGcxejI","gamedata_mine",void 0);var m=e("default",function(){function e(){}return e.init=function(){var e=this;a("GameMineManager","Items",(function(){e.updateMineItems()})),a("GameMineManager","Deep",(function(){g.trigger(s.SYSTEM_UNLOCK)})),u.register(c.MineOpen,this.onResMineOpen,this),u.register(c.MineDig,this.onResMineDig,this),u.register(c.MineCheckTieGao,this.onCheckTiegao,this)},e.updateMineItems=function(){this.updateMoldIcons(),g.trigger(s.GAME_DATA_MINE)},e.updateMoldIcons=function(){for(var e in this.moldIcons)Object.prototype.hasOwnProperty.call(this.moldIcons,e)&&delete this.moldIcons[e];var t=r.mine.Molds.value;if(t)for(var i in t){var a=t[i];if(a){var s=a.moldId,u=n.getCfgByObjId(o.MineMoldConfig,s);if(u&&u.position){var c=u.position.split(",");if(Array.isArray(c)&&2==c.length){var g=this.generateMineItemKey(a.X+parseInt(c[0])-1,a.Y+parseInt(c[1])-1);this.moldIcons[g]=u.moldIcon}}}}},e.generateMineItemKey=function(e,t){return(t<<8)+e},e.getMoldIcon=function(e){return this.moldIcons[e]},e.onResMineOpen=function(e){this.updateMoldIcons(),this.updateCD(e),this.updateTeigaoMax(e)},e.onResMineDig=function(e){this.updateMoldIcons(),this.updateCD(e)},e.onCheckTiegao=function(e){this.updateCD(e),this.updateTeigaoMax(e)},e.updateCD=function(e){if(e){var t=e.cd;if(t){this.cd=t;var i=e.cdLeft||0,n=f.getServerTime();this.lastRecoveryTime=n-(t-i),g.trigger(s.MINE_CD_UPDATE)}}},e.updateTeigaoMax=function(e){this._tiegaoMaxNum=e?e.TieGaoMax:0},e.getItemCount=function(e){var t=r.bag.getItemCount(e)||0;return e==d.ItemId.Tiegao?t+(this.getRecoveryNum()||0):t},e.getRecoveryNum=function(){var e=this.lastRecoveryTime,t=this.cd;if(!e||!t)return 0;var i=f.getServerTime()-e;if(i<=0)return 0;var n=Math.floor(i/t),o=r.bag.getItemCount(d.ItemId.Tiegao),a=this.tiegaoMaxNum;return o>=a?n=0:n+o>a&&(n=a-o),n},t(e,null,[{key:"tiegaoMaxNum",get:function(){return null==this._tiegaoMaxNum&&(this._tiegaoMaxNum=d.TieGaoMax),this._tiegaoMaxNum||0}}]),e}());m.lastRecoveryTime=0,m.cd=void 0,m.cdLeft=void 0,m._tiegaoMaxNum=void 0,m.moldIcons={},i._RF.pop()}}}));

System.register("chunks:///_virtual/mine_common_item_view.ts",["./rollupPluginModLoBabelHelpers.js","cc","./game_event.ts","./global_functions.ts","./notifier_center.ts","./util.ts","./gamedata_mine.ts","./mine_const.ts","./mine_utils.ts","./PanelManager.ts","./AssetPath.ts"],(function(t){"use strict";var e,i,n,o,s,a,u,l,c,r,h,d,m,f,b,p,I,v,C,T,E,g,_,N,y;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){s=t.cclegacy,a=t._decorator,u=t.Node,l=t.Button,c=t.Label,r=t.UITransform,h=t.v3,d=t.Tween,m=t.tween,f=t.Vec3,b=t.NodeEventType,p=t.Component},function(t){I=t.GameEventType},function(t){v=t.GF},function(t){C=t.Notifier},function(t){T=t.Util},function(t){E=t.default},function(t){g=t.MineConst},function(t){_=t.default},function(t){N=t.PanelManager},function(t){y=t.emPanel}],execute:function(){var w,U,M,k,A,R,z,L,S,O,P,H,x,B,D,G,V,F,Z,j,q,J,K,Y,Q,W;s._RF.push({},"59ef8SJd/5ErK7rz1ixipEz","mine_common_item_view",void 0);var X=a.ccclass,$=a.property;t("MineCommonItemView",(w=$(u),U=$(u),M=$(u),k=$(l),A=$(u),R=$(u),z=$(c),L=$(u),S=$(c),O=$(c),P=$(u),H=$(u),X((D=e((B=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return(e=t.call.apply(t,[this].concat(s))||this).touching=!1,e.selectCallback=void 0,e.touchMoveCallback=void 0,e.touchEndCallback=void 0,e.touchCancelCallback=void 0,e.adButtonEnabled=!0,n(e,"selected",D,o(e)),n(e,"move",G,o(e)),n(e,"video",V,o(e)),n(e,"videoBtn",F,o(e)),n(e,"adNode",Z,o(e)),n(e,"freeAdNode",j,o(e)),n(e,"videoCnt",q,o(e)),n(e,"videoTips",J,o(e)),n(e,"videoTipsNumLbl",K,o(e)),n(e,"lblNum",Y,o(e)),n(e,"sprItem",Q,o(e)),n(e,"unusable",W,o(e)),e.itemId=null,e}i(e,t);var s=e.prototype;return s.onClickMineItem=function(){this.selectCallback&&this.selectCallback(this.itemId)},s.onClickVideo=function(){if(this.adButtonEnabled)g.ItemId2FuncId[this.itemId]},s.onGetAdReward=function(t){if(t){var e=_.makeItemIdNumMap(t.Rewards);e&&0!=Object.keys(e).length&&N.getInstance().addPopUpView(y.mine_reward_window,{rewards:e})}},s.onLoad=function(){C.listen(I.GAME_DATA_USER,this.onEvtItemUpdate,this),C.listen(I.MINE_RECOVERY_UPDATE,this.updateItemNum,this),C.listen(I.MINE_SELECT_GREEN,this.onEvtGreen,this),C.listen(I.MINE_SELECT_NONE,this.onEvtGreen,this),C.listen(I.MINE_SELECT_RED,this.onEvtRed,this),this.setSelected(!1),this.setUnusable(!1)},s.onEnable=function(){this.updateItemNum()},s.onItemTouchStart=function(t){this.hasItem()&&(this.touching=!0,this.node.setSiblingIndex(this.node.parent.children.length-1),this.updateTouchItem(t))},s.onItemTouchMove=function(t){this.hasItem()&&(this.updateTouchItem(t),this.touchMoveCallback&&this.touchMoveCallback(t))},s.onItemTouchEnd=function(t){this.hasItem()&&(this.touching=!1,this.onTouchRelease(t))},s.onItemTouchCancel=function(t){this.hasItem()&&(this.touching=!1,this.onTouchRelease(t))},s.onTouchRelease=function(t){this.resetTouchItem(),v.nodeContainsPos(this.node,t.getUILocation())?this.selectCallback&&this.selectCallback(this.itemId):this.touchEndCallback&&this.touchEndCallback(t)},s.updateTouchItem=function(t){var e=t.getUILocation(),i=t.getUIStartLocation(),n=e.x-i.x,o=e.y-i.y;if(Math.sqrt(n*n+o*o)>=20){this.selectCallback&&this.selectCallback(this.itemId);var s=this.node.getComponent(r).convertToNodeSpaceAR(h(e.x,e.y,0));this.move.setPosition(s.x,s.y,0)}else this.move.setPosition(0,0,0)},s.resetTouchItem=function(){this.setUnusable(!1),d.stopAllByTarget(this.move);var t=Math.sqrt(this.move.position.x*this.move.position.x+this.move.position.y*this.move.position.y);m(this.move).to(t/2e3,{position:f.ZERO}).start()},s.initParams=function(t){t&&t.itemId&&(this.itemId=t.itemId),this.initUI(),this.updateAdNum()},s.initUI=function(){this.updateItemNum()},s.updateAd=function(){this.adButtonEnabled=!1,this.video.active=!1},s.updateAdNum=function(){switch(this.itemId){case g.ItemId.Tiegao:case g.ItemId.Zhayao:case g.ItemId.Zuantou:}},s.updateItemNum=function(){if(this.itemId){var t=this.itemId,e=E.getItemCount(t);this.setLblNum(e),this.updateAd()}},s.hasItem=function(){return(E.getItemCount(this.itemId)||0)>0},s.onEvtGreen=function(){this.touching&&this.setUnusable(!1)},s.onEvtRed=function(){this.touching&&this.setUnusable(!0)},s.initMineItem=function(t,e,i,n,o,s){this.initParams(t),this.node.off(b.TOUCH_START,this.onItemTouchStart,this),this.node.off(b.TOUCH_MOVE,this.onItemTouchMove,this),this.node.off(b.TOUCH_END,this.onItemTouchEnd,this),this.node.off(b.TOUCH_CANCEL,this.onItemTouchCancel,this),e&&(this.node.on(b.TOUCH_START,this.onItemTouchStart,this),this.node.on(b.TOUCH_MOVE,this.onItemTouchMove,this),this.node.on(b.TOUCH_END,this.onItemTouchEnd,this),this.node.on(b.TOUCH_CANCEL,this.onItemTouchCancel,this)),this.selectCallback=i,this.touchMoveCallback=n,this.touchEndCallback=o,this.touchCancelCallback=s},s.setSelected=function(t){this.selected&&(this.selected.active=!!t)},s.setUnusable=function(t){this.unusable&&(this.unusable.active=1==t)},s.setLblNum=function(t){this.lblNum.string=T.formatNumber(t)},s.onEvtItemUpdate=function(t){t&&t===this.itemId&&this.node&&this.node.activeInHierarchy&&this.updateItemNum()},e}(p)).prototype,"selected",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(B.prototype,"move",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(B.prototype,"video",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(B.prototype,"videoBtn",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=e(B.prototype,"adNode",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(B.prototype,"freeAdNode",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=e(B.prototype,"videoCnt",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=e(B.prototype,"videoTips",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(B.prototype,"videoTipsNumLbl",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=e(B.prototype,"lblNum",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=e(B.prototype,"sprItem",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(B.prototype,"unusable",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=B))||x));s._RF.pop()}}}));

System.register("chunks:///_virtual/mine_const.ts",["cc"],(function(e){"use strict";var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"66d73c4rkxL+7z6980KuB9K","mine_const",void 0);e("MineConst",{TieGaoMax:60,DigDelta:1e3,SlotType:{Blank:1,Stone:2,Soil:3},ItemId:{Tiegao:11070001,Zuantou:11070002,Zhayao:11070003,Lingshi:11070004,Diamond:11011001,Coin:11011002},ItemId2FuncId:{},OreShowType:{Pile:1,Num:2,None:3,Box:4},MineItemPath:"images/hall/mine/",SizeWithPadding:90}),e("MattockShape",[[0,0]]),e("ExplosiveShape",[[0,0],[-1,0],[1,0],[-2,0],[2,0],[0,1],[0,-1],[0,2],[0,-2],[-1,-1],[1,1],[-1,1],[1,-1]]),e("MineMapSize",{rowCnt:7,colCnt:6});t._RF.pop()}}}));

System.register("chunks:///_virtual/mine_help_window.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PanelBase.ts","./ui_enum.ts"],(function(e){"use strict";var i,n,t,o,r,c,l,a,s;return{setters:[function(e){i=e.applyDecoratedDescriptor,n=e.inheritsLoose,t=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,c=e._decorator,l=e.Node},function(e){a=e.default},function(e){s=e.WindowAnimationType}],execute:function(){var u,p,d,f,h,w,m;r._RF.push({},"720eaaGjSxOgYZBxX7eU+UB","mine_help_window",void 0);var y=c.ccclass,_=c.property;e("MineHelpWindow",(u=_(l),p=_(l),y(((m=function(e){function i(){for(var i,n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(i=e.call.apply(e,[this].concat(r))||this).winAnim=s.Scale,i.mask=204,t(i,"firstNode",h,o(i)),t(i,"secondNode",w,o(i)),i}n(i,e);var r=i.prototype;return r.onClickFirst=function(){this.firstNode.active=!1,this.secondNode.active=!0},r.onClickSecond=function(){this.closeSelf()},i}(a)).resourceFile="prefab/hall/mine/mine_help_window",h=i((f=m).prototype,"firstNode",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=i(f.prototype,"secondNode",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=f))||d));r._RF.pop()}}}));

System.register("chunks:///_virtual/mine_item_comp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global_functions.ts","./gamedata_mine.ts","./mine_const.ts","./mine_utils.ts","./LocalConfig.ts","./ConfigLoader.ts"],(function(e){"use strict";var t,i,n,r,o,a,l,s,c,u,p,h,g,m,d,f,b,y,k,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,l=e.Sprite,s=e.Node,c=e.Label,u=e.Tween,p=e.tween,h=e.UITransform,g=e.Vec3,m=e.Component},function(e){d=e.GF},function(e){f=e.default},function(e){b=e.MineConst},function(e){y=e.default},function(e){k=e.LocalConfig},function(e){v=e.ConfigPath}],execute:function(){var _,w,S,F,T,I,P,B,M,C,z,A,R,L,x,N;o._RF.push({},"1b046WwbVVKXZ+08E12U2wh","mine_item_comp",void 0);var O=a.ccclass,W=a.property;e("MineItemComp",(_=W(l),w=W(l),S=W(s),F=W(l),T=W(l),I=W(c),P=W(s),O((C=t((M=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,n(t,"bg",C,r(t)),n(t,"room",z,r(t)),n(t,"light",A,r(t)),n(t,"reward",R,r(t)),n(t,"black",L,r(t)),n(t,"pos",x,r(t)),n(t,"crack",N,r(t)),t.red=null,t.green=null,t.tempSpriteFrameAndAngle={spriteFrame:null,blackSpriteFrame:null,angle:0},t}i(t,e);var o=t.prototype;return o.init=function(e,t,i){this.red=i.getChildByName("red"),this.green=i.getChildByName("green"),this.updateUI(e,t)},o.updateUI=function(e,t){this.bg.spriteFrame=null,this.room.spriteFrame=null,this.reward.spriteFrame=null,this.black.spriteFrame=null,this.crack&&(this.crack.active=!1);var i=this.getSpriteFrameAndAngle(e,this.tempSpriteFrameAndAngle),n=""+b.MineItemPath+i.spriteFrame,r=""+b.MineItemPath+i.blackSpriteFrame,o=f.getMoldIcon(y.getMineItemKey(e));if(o&&(i.angle=0),i.spriteFrame?d.setTexture(this.bg,n):this.bg.spriteFrame=null,this.node.angle=i.angle,d.setTexture(this.black,r),this.black.node.active=!y.isBright(e),this.pos.node.active=!1,this.crack&&y.isBright(e)&&y.isStoneType(e)&&(this.crack.active=!!e.HP&&1===e.HP,this.crack.angle=-i.angle),e.OreType){var a=k.getCfgByObjId(v.MineOreConfig,e.OreType);a&&d.setTexture(this.reward,""+b.MineItemPath+a.oreIcon)}this.reward.node.angle=-i.angle,this.reward.node.active=y.hasReward(e),this.room.node.active=!1,o&&(d.setTexture(this.room,y.getRoomIconPath(o)),this.room.node.setPosition(-b.SizeWithPadding/2,b.SizeWithPadding/2),this.room.node.active=!0),this.light.active=!1,y.isBlankType(e)&&y.hasReward(e)&&(this.light.active=!0,u.stopAllByTarget(this.light),p(this.light).by(2,{angle:360}).repeatForever().start())},o.clearSelected=function(){this.red.active=!1,this.green.active=!1},o.setRed=function(){this.red.active=!0},o.setGreen=function(){this.green.active=!0},o.hideMineItemNode=function(){this.bg.spriteFrame=null,this.black.spriteFrame=null,this.crack&&(this.crack.active=!1),this.reward.node.active=!1},o.setCrack=function(){this.crack&&(this.crack.active=!0)},o.getNodeWorldPos=function(){return this.node.getComponent(h).convertToWorldSpaceAR(g.ZERO)},o.getSpriteFrameAndAngle=function(e,t){(t=t||{}).spriteFrame=null,t.blackSpriteFrame=null,t.angle=0;var i=e.X,n=e.Y,r=e.SlotType,o=y.getMineItemByPosition(i-1,n),a=y.getMineItemByPosition(i+1,n),l=y.getMineItemByPosition(i,n-1),s=y.getMineItemByPosition(i,n+1),c=!!o&&o.SlotType==r,u=!!a&&a.SlotType==r,p=!!l&&l.SlotType==r,h=!!s&&s.SlotType==r,g=0;c&&g++,u&&g++,p&&g++,h&&g++;var m=r==b.SlotType.Soil||r==b.SlotType.Blank,d=r==b.SlotType.Stone,f=0,k=null;switch(g){case 0:m?k="soil_full":d&&(k="stone_full");break;case 1:c?f=0:u?f=180:p?f=-90:h&&(f=90),m?k="soil_three":d&&(k="stone_three");break;case 2:var v=!1;p&&u?f=180:u&&h?f=90:h&&c?f=0:c&&p?f=-90:p&&h?(f=90,v=!0):c&&u&&(f=0,v=!0),m?k=v?"soil_two_opposite":"soil_two_near":d&&(k=v?"stone_two_opposite":"stone_two_near");break;case 3:c?u?p?h||(f=-90):f=90:f=0:f=180,m?k="soil_one":d&&(k="stone_one");break;case 4:m?k="soil_none":d&&(k="stone_none")}return r!=b.SlotType.Blank&&(t.spriteFrame=k),t.blackSpriteFrame=k,t.angle=f,t},t}(m)).prototype,"bg",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(M.prototype,"room",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(M.prototype,"light",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(M.prototype,"reward",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(M.prototype,"black",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(M.prototype,"pos",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=t(M.prototype,"crack",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=M))||B));o._RF.pop()}}}));

System.register("chunks:///_virtual/mine_item_tiegao_view.ts",["./rollupPluginModLoBabelHelpers.js","cc","./game_event.ts","./notifier_center.ts","./util.ts","./gamedata_mine.ts","./mine_const.ts"],(function(t){"use strict";var e,i,n,o,r,u,a,s,m,l,c,p,f,d;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,u=t._decorator,a=t.Label,s=t.Node,m=t.Component},function(t){l=t.GameEventType},function(t){c=t.Notifier},function(t){p=t.Util},function(t){f=t.default},function(t){d=t.MineConst}],execute:function(){var I,h,_,v,N,b;r._RF.push({},"02682e9j75NEowBvTD+S+OY","mine_item_tiegao_view",void 0);var g=u.ccclass,y=u.property;t("MineItemTiegaoView",(I=y(a),h=y(s),g((N=e((v=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),u=0;u<i;u++)r[u]=arguments[u];return e=t.call.apply(t,[this].concat(r))||this,n(e,"lblNum",N,o(e)),n(e,"sprItem",b,o(e)),e.itemId=null,e}i(e,t);var r=e.prototype;return r.onLoad=function(){c.listen(l.GAME_DATA_USER,this.onEvtItemUpdate,this),c.listen(l.MINE_RECOVERY_UPDATE,this.updateItemNum,this)},r.onEnable=function(){this.updateItemNum()},r.initParams=function(t){t&&t.itemId&&(this.itemId=t.itemId),this.initUI()},r.initUI=function(){this.updateItemNum()},r.onEvtItemUpdate=function(t){t===d.ItemId.Tiegao&&this.node&&this.node.activeInHierarchy&&this.updateItemNum()},r.updateItemNum=function(){if(this.itemId){var t=this.itemId,e=f.getItemCount(t);this.setLblNum(e)}},r.setLblNum=function(t){var e=p.formatNumber(t),i=f.tiegaoMaxNum;this.lblNum.string=e+"/"+i},e}(m)).prototype,"lblNum",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=e(v.prototype,"sprItem",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=v))||_));r._RF.pop()}}}));

System.register("chunks:///_virtual/mine_main_window.ts",["./rollupPluginModLoBabelHelpers.js","cc","./fly_anim.ts","./gravity_comp.ts","./ui_enum.ts","./GameData.ts","./assets_loader.ts","./audio_helper.ts","./game_event.ts","./global_functions.ts","./message_manager.ts","./notifier_center.ts","./server_time.ts","./common_item_view.ts","./gamedata_mine.ts","./mine_common_item_view.ts","./mine_const.ts","./mine_item_tiegao_view.ts","./mine_message.ts","./mine_utils.ts","./PanelManager.ts","./AssetPath.ts","./PanelBaseNoMask.ts"],(function(e){"use strict";var t,i,n,o,a,r,s,l,h,u,m,d,c,p,g,f,I,b,y,v,w,P,D,N,T,M,S,A,z,C,k,_,B,E,R,G,V,O,W,x,L,U;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){a=e.cclegacy,r=e._decorator,s=e.Prefab,l=e.Node,h=e.Label,u=e.sp,m=e.NodePool,d=e.Vec3,c=e.NodeEventType,p=e.isValid,g=e.Tween,f=e.tween,I=e.UITransform,b=e.v3},function(e){y=e.FlyAnimType},function(e){v=e.default},function(e){w=e.DisplayType},function(e){P=e.GD},function(e){D=e.AssetsLoader},function(e){N=e.AudioHelper},function(e){T=e.GameEventType},function(e){M=e.GF},function(e){S=e.MessageManager,A=e.ClientProtocols},function(e){z=e.Notifier},function(e){C=e.ServerTime},function(e){k=e.CommonItemView},function(e){_=e.default},function(e){B=e.MineCommonItemView},function(e){E=e.MineConst,R=e.ExplosiveShape,G=e.MattockShape},function(e){V=e.MineItemTiegaoView},function(e){O=e.MineMessage},function(e){W=e.default},function(e){x=e.PanelManager},function(e){L=e.emPanel},function(e){U=e.default}],execute:function(){var F,Z,Y,X,H,K,q,j,J,Q,$,ee,te,ie,ne,oe,ae,re,se,le,he,ue,me,de,ce,pe,ge,fe,Ie,be,ye,ve,we,Pe,De,Ne,Te,Me,Se,Ae,ze,Ce,ke,_e,Be,Ee,Re,Ge,Ve,Oe,We,xe,Le,Ue,Fe,Ze,Ye,Xe,He,Ke,qe,je,Je,Qe,$e,et,tt,it,nt,ot,at,rt,st,lt,ht,ut,mt,dt,ct,pt,gt,ft,It,bt,yt,vt,wt,Pt,Dt,Nt,Tt,Mt,St,At,zt;a._RF.push({},"d069fshNC1LF4HuMjgCh8Rs","mine_main_window",void 0);var Ct=r.ccclass,kt=r.property,_t=1,Bt=2,Et=3,Rt=4,Gt=5,Vt=6,Ot=7,Wt=8,xt={path:"prefab/hall/mine/fx/spine/Ui_Kd_yemian_hou",skin:"default",animation:"animation"},Lt={path:"prefab/hall/mine/fx/spine/Ui_Kd_yemian_qian",skin:"default",animation:"animation"},Ut={path:"prefab/hall/mine/fx/spine/Ui_kd_xaren_tieqiao",skin:"default"},Ft={path:"prefab/hall/mine/fx/spine/Ui_kd_xaren_zhadan",skin:"default"};e("MineMainWindow",(F=kt(s),Z=kt(s),Y=kt(s),X=kt(l),H=kt(l),K=kt(l),q=kt(l),j=kt(l),J=kt(l),Q=kt({type:[l]}),$=kt(l),ee=kt(l),te=kt(l),ie=kt(l),ne=kt(l),oe=kt(l),ae=kt(l),re=kt(l),se=kt(h),le=kt(l),he=kt(l),ue=kt(l),me=kt(l),de=kt(l),ce=kt(l),pe=kt(u.Skeleton),ge=kt(u.Skeleton),fe=kt(l),Ie=kt(l),be=kt(k),ye=kt(l),ve=kt(k),we=kt(l),Pe=kt(V),De=kt(k),Ne=kt(l),Te=kt(B),Me=kt(l),Se=kt(B),Ae=kt(l),ze=kt(B),Ce=kt(l),ke=kt(h),_e=kt(u.Skeleton),Be=kt(u.Skeleton),Ee=kt(l),Ct(((zt=function(e){function t(){for(var t,i,a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(i=e.call.apply(e,[this].concat(r))||this).displayType=w.FullCover,i.autoRelease=!1,i.rowCnt=7,i.colCnt=6,i.gridSize=94,i.gridPadding=-4,i.gridSizeWithPadding=90,i.viewDepth=-1,i.curDigItemId=void 0,i.tempGridPosition={x:0,y:0},i.touchGridX=void 0,i.touchGridY=void 0,i.firstVisibleDepth=void 0,i.lastVisibleDepth=void 0,i.mineItemComps={},i.lastDiggingTime=0,i.msgMineItem=void 0,i.msgItemId=void 0,i.msgFirstDepth=void 0,i.msgLastDepth=void 0,i.gridsInited=!1,n(i,"rewardTipsPrefab",Ve,o(i)),n(i,"soilDispPfb",Oe,o(i)),n(i,"stoneDispPfb",We,o(i)),i.nodePool=((t={})[_t]=new m,t[Bt]=new m,t[Et]=new m,t[Rt]=new m,t[Gt]=new m,t[Vt]=new m,t[Ot]=new m,t[Wt]=new m,t),i.lastMineItemData={},i.rewardData=void 0,i.popWindowRewardData=void 0,i.flyPos={},i.zhafeiPfbNode=null,i.lingshiAddition=0,i.flyScale=new d(1.5,1.5,1.5),n(i,"toInstBg",xe,o(i)),n(i,"toInstStoneBg",Le,o(i)),n(i,"toInstSelect",Ue,o(i)),n(i,"toInstFly",Fe,o(i)),n(i,"toInstBoom",Ze,o(i)),n(i,"moveBgNode",Ye,o(i)),n(i,"moveBgSubNodes",Xe,o(i)),n(i,"mineArea",He,o(i)),n(i,"gridsNode",Ke,o(i)),n(i,"gridsShakeNode",qe,o(i)),n(i,"moveAnimDownNode",je,o(i)),n(i,"moveAnimUpNode",Je,o(i)),n(i,"soilBgParent",Qe,o(i)),n(i,"stoneBgParent",$e,o(i)),n(i,"selectPrent",et,o(i)),n(i,"depthLbl",tt,o(i)),n(i,"leftGear",it,o(i)),n(i,"rightGear",nt,o(i)),n(i,"itemDispAnimParent",ot,o(i)),n(i,"boomAnimParent",at,o(i)),n(i,"zhafei",rt,o(i)),n(i,"rewardTipsAnimParent",st,o(i)),n(i,"tiegaoDigSpine",lt,o(i)),n(i,"zhayaoDigSpine",ht,o(i)),n(i,"zuantouDigNode",ut,o(i)),n(i,"flyAnimParent",mt,o(i)),n(i,"coinItemView",dt,o(i)),n(i,"coinIconNode",ct,o(i)),n(i,"diamondItemView",pt,o(i)),n(i,"diamondIconNode",gt,o(i)),n(i,"tiegaoTopItemView",ft,o(i)),n(i,"lingshiItemView",It,o(i)),n(i,"lingshiIconNode",bt,o(i)),n(i,"zuantouItemView",yt,o(i)),n(i,"zuantouIconNode",vt,o(i)),n(i,"zhayaoItemView",wt,o(i)),n(i,"zhayaoIconNode",Pt,o(i)),n(i,"tiegaoBottomItemView",Dt,o(i)),n(i,"tiegaoIconNode",Nt,o(i)),n(i,"countdown",Tt,o(i)),n(i,"workerDown",Mt,o(i)),n(i,"workerUp",St,o(i)),n(i,"leftCorner",At,o(i)),i}i(t,e);var a=t.prototype;return a.onClickClose=function(){this.closeSelf()},a.onClickHelp=function(){x.getInstance().addPopUpView(L.mine_help_window,{})},a.onLoad=function(){this.gridsNode.on(c.TOUCH_START,this.onGridsTouchStart,this),this.gridsNode.on(c.TOUCH_MOVE,this.onGridsTouchMove,this),this.gridsNode.on(c.TOUCH_END,this.onGridsTouchEnd,this),this.gridsNode.on(c.TOUCH_CANCEL,this.onGridsTouchCancel,this),z.listen(T.GAME_DATA_MINE,this.onEvtDateMine,this),z.listen(T.MINE_RECOVERY_UPDATE,this.onEvtRecoveryUpdate,this),z.listen(T.GAME_DATA_ERROR,this.onEvtError,this),S.register(A.MineDig,this.onResMineDig,this),S.register(A.MineGetItem,this.onResMineGetItem,this),_.init(),this.initFlyPos(),this.initPools(),this.loadAssets()},a.loadAssets=function(){var e=this;this.loadSpine(this.workerDown,xt),this.loadSpine(this.workerUp,Lt),this.loadSpine(this.tiegaoDigSpine,Ut),this.loadSpine(this.zhayaoDigSpine,Ft),this.loadPfb("prefab/hall/mine/fx/zhafei_xiaoren",this.zhafei,(function(t){e.zhafeiPfbNode=t}))},a.loadSpine=function(e,t){M.setSpine(e,t.path,(function(i,n){!i&&p(e.node)&&(t.skin&&e.setSkin(t.skin),t.animation&&e.setAnimation(0,t.animation,!0))}))},a.loadPfb=function(e,t,i){D.loadPrefab(e,(function(e,n){if(!e&&p(t)){var o=M.instantiate(n);o.parent=t,i&&i(o)}}))},a.onSetData=function(t){e.prototype.onSetData.call(this,t),this.initItems(),this.setCurDigItemId(E.ItemId.Tiegao),this.updateMineItemNodes(),this.updateRecovery()},a.initItems=function(){this.coinItemView.initParams({itemId:E.ItemId.Coin}),this.diamondItemView.initParams({itemId:E.ItemId.Diamond}),this.tiegaoTopItemView.initParams({itemId:E.ItemId.Tiegao}),this.lingshiItemView.initParams({itemId:E.ItemId.Lingshi}),this.tiegaoBottomItemView.initMineItem({itemId:E.ItemId.Tiegao},!0,this.itemSelectCallback.bind(this),this.itemTouchMoveCallback.bind(this),this.itemTouchEndCallback.bind(this),this.itemTouchCancelCallback.bind(this)),this.zuantouItemView.initMineItem({itemId:E.ItemId.Zuantou},!0,this.itemSelectCallback.bind(this),this.itemTouchMoveCallback.bind(this),this.itemTouchEndCallback.bind(this),this.itemTouchCancelCallback.bind(this)),this.zhayaoItemView.initMineItem({itemId:E.ItemId.Zhayao},!0,this.itemSelectCallback.bind(this),this.itemTouchMoveCallback.bind(this),this.itemTouchEndCallback.bind(this),this.itemTouchCancelCallback.bind(this))},a.itemSelectCallback=function(e){this.setCurDigItemId(e)},a.itemTouchMoveCallback=function(e){M.nodeContainsPos(this.mineArea,e.getUILocation())?this.updateTouchGrid(e):this.onTouchCancel()},a.itemTouchEndCallback=function(e){M.nodeContainsPos(this.mineArea,e.getUILocation())&&this.digByTouch(e),this.resetDigItem()},a.itemTouchCancelCallback=function(e){this.onTouchCancel()},a.setCurDigItemId=function(e){this.curDigItemId!==e&&(this.curDigItemId=e,this.tiegaoBottomItemView.setSelected(e==E.ItemId.Tiegao),this.zuantouItemView.setSelected(e==E.ItemId.Zuantou),this.zhayaoItemView.setSelected(e==E.ItemId.Zhayao))},a.resetDigItem=function(){this.setCurDigItemId(E.ItemId.Tiegao)},a.onDestroy=function(){e.prototype.onDestroy.call(this),this.clearPool(),z.unlisten(T.GAME_DATA_MINE,this.onEvtDateMine,this),z.unlisten(T.MINE_RECOVERY_UPDATE,this.onEvtRecoveryUpdate,this),z.unlisten(T.GAME_DATA_ERROR,this.onEvtError,this),S.unregister(A.MineDig,this.onResMineDig,this),S.unregister(A.MineGetItem,this.onResMineGetItem,this)},a.clearPool=function(){if(this.nodePool)for(var e in this.nodePool){if(Object.prototype.hasOwnProperty.call(this.nodePool,e))this.nodePool[e].clear()}},a.initFlyPos=function(){var e=this;this.scheduleOnce((function(){p(e.node)&&(e.flyPos[E.ItemId.Lingshi]=W.getNodeWorldPos(e.lingshiIconNode),e.flyPos[E.ItemId.Zuantou]=W.getNodeWorldPos(e.zuantouIconNode),e.flyPos[E.ItemId.Zhayao]=W.getNodeWorldPos(e.zhayaoIconNode),e.flyPos[E.ItemId.Tiegao]=W.getNodeWorldPos(e.tiegaoIconNode),e.flyPos[E.ItemId.Coin]=W.getNodeWorldPos(e.coinIconNode),e.flyPos[E.ItemId.Diamond]=W.getNodeWorldPos(e.diamondIconNode))}))},a.initPools=function(){for(var e=0;e<20;e++){var t=this.generatePoolNode(_t),i=this.generatePoolNode(Bt);this.putNodeToPool(_t,t),this.putNodeToPool(Bt,i)}for(var n=0;n<3;n++){var o=this.generatePoolNode(Et),a=this.generatePoolNode(Rt),r=this.generatePoolNode(Gt),s=this.generatePoolNode(Ot),l=this.generatePoolNode(Wt);this.putNodeToPool(Et,o),this.putNodeToPool(Rt,a),this.putNodeToPool(Gt,r),this.putNodeToPool(Ot,s),this.putNodeToPool(Wt,l)}for(var h=0;h<42;h++){var u=this.generatePoolNode(Vt);this.putNodeToPool(Vt,u)}},a.generatePoolNode=function(e){var t;switch(e){case _t:t=M.instantiate(this.toInstBg,"mine_item_comp");break;case Bt:t=M.instantiate(this.toInstStoneBg,"mine_item_comp");break;case Et:t=M.instantiate(this.soilDispPfb);break;case Rt:t=M.instantiate(this.stoneDispPfb);break;case Gt:t=M.instantiate(this.rewardTipsPrefab,"mine_reward_tips");break;case Vt:t=M.instantiate(this.toInstSelect);break;case Ot:t=M.instantiate(this.toInstFly,"fly_anim");break;case Wt:t=M.instantiate(this.toInstBoom)}return t},a.getNodeFromPool=function(e){var t=this.nodePool[e];if(t)return t.get()||this.generatePoolNode(e)},a.putNodeToPool=function(e,t){var i=this.nodePool[e];i&&i.put(t)},a.updateDepthLbl=function(){var e=P.mine.Deep.value;this.depthLbl.string=e+"m"},a.playGearAnim=function(e){g.stopAllByTarget(this.leftGear),g.stopAllByTarget(this.rightGear),f(this.leftGear).by(e,{angle:360}).start(),f(this.rightGear).by(e,{angle:-360}).start()},a.updateMineItemNodes=function(){var e=this,t=P.mine,i=t.Items,n=t.Deep.value+1,o=n-this.rowCnt+1;n<7&&(o=1,n=7),this.firstVisibleDepth=o,this.lastVisibleDepth=n;var a=0;this.viewDepth>0&&n>this.viewDepth&&(a=n-this.viewDepth);var r=a>0;this.viewDepth=n;var s=0;for(var l in this.mineItemComps)Object.prototype.hasOwnProperty.call(this.mineItemComps,l)&&s++;if(this.lastMineItemData={},a||!this.gridsInited||0==s){this.gridsInited=!0;for(var h=this.soilBgParent.children,u=h.length-1;u>=0;u--){var m=h[u];this.putNodeToPool(_t,m)}for(var c=(h=this.stoneBgParent.children).length-1;c>=0;c--){var p=h[c];this.putNodeToPool(Bt,p)}for(var y=(h=this.selectPrent.children).length-1;y>=0;y--){var v=h[y];this.putNodeToPool(Vt,v)}this.mineItemComps={};for(var w=Math.max(1,o-a);w<=n+1;w++)if(i.get(W.generateMineItemKey(1,w)))for(var D=1;D<=this.colCnt;D++){var N=W.generateMineItemKey(D,w),T=i.get(N),M=W.isStoneType(T),S=this.getNodeFromPool(M?Bt:_t);S.setPosition(this.getMineItemNodeX(D),this.getMineItemNodeY(w)),S.parent=M?this.stoneBgParent:this.soilBgParent;var A=this.getNodeFromPool(Vt);A.setPosition(S.position),A.parent=this.selectPrent;var z=S.getComponent("mine_item_comp");z.init(T,this,A),this.mineItemComps[N]=z,this.lastMineItemData[N]={slotType:T.SlotType,hp:T.HP,boxId:T.BoxId}}this.gridsNode.getComponent(I).height=this.gridSizeWithPadding*(n+1);var C=(this.firstVisibleDepth-1)*this.gridSizeWithPadding;if(r){var k=.5;this.moveBg(k,C),this.playWorkerAnim(),g.stopAllByTarget(this.gridsShakeNode),g.stopAllByTarget(this.gridsNode),g.stopAllByTarget(this.moveAnimDownNode),g.stopAllByTarget(this.moveAnimUpNode),f(this.gridsShakeNode).sequence(f(this.gridsShakeNode).by(.08,{position:b(-2,0,0)},{easing:"elasticOut"}),f(this.gridsShakeNode).by(.08,{position:b(2,0,0)},{easing:"elasticOut"}),f(this.gridsShakeNode).by(.08,{position:b(2,0,0)},{easing:"elasticOut"}),f(this.gridsShakeNode).by(.08,{position:b(-2,0,0)},{easing:"elasticOut"})).repeatForever().start(),f(this.gridsNode).to(k,{position:new d(this.gridsNode.position.x,C,0)}).call((function(){g.stopAllByTarget(e.gridsShakeNode),e.gridsShakeNode.setPosition(d.ZERO)})).start(),f(this.moveAnimDownNode).to(k,{position:new d(this.moveAnimDownNode.position.x,C,0)}).start(),f(this.moveAnimUpNode).to(k,{position:new d(this.moveAnimUpNode.position.x,C,0)}).start(),this.playGearAnim(k)}else this.moveBg(0,C),this.gridsNode.setPosition(this.gridsNode.position.x,C,0),this.moveAnimDownNode.setPosition(this.moveAnimDownNode.position.x,C,0),this.moveAnimUpNode.setPosition(this.moveAnimUpNode.position.x,C,0)}else for(var _=o;_<=n+1;_++)for(var B=1;B<=this.colCnt;B++){var E=W.generateMineItemKey(B,_),R=i.get(E);if(R){var G=this.getMineItemComp(B,_);G&&G.updateUI(R,this),this.lastMineItemData[E]={slotType:R.SlotType,hp:R.HP,boxId:R.BoxId}}else console.log("mine items 不存在key ",B,_,E,n)}this.updateDepthLbl()},a.moveBg=function(e,t){var i=this;g.stopAllByTarget(this.moveBgNode),f(this.moveBgNode).to(e,{position:new d(this.moveBgNode.position.x,t,0)}).call((function(){var e=Math.ceil(t/488);i.moveBgSubNodes.forEach((function(t,i){t.setPosition(0,488*-(e+i-4),0)}))})).start()},a.playWorkerAnim=function(){var e=this;this.workerDown.setCompleteListener((function(){e.workerDown.setCompleteListener(null),e.workerDown.setAnimation(0,"loop",!0)})),this.workerDown.setAnimation(0,"skill",!1)},a.updateRecovery=function(){var e=_.lastRecoveryTime,t=_.cd;if(e&&t){var i=C.getServerTime(),n=_.getRecoveryNum(),o=e+t*(n+1)-i;if(n>0)0==(P.bag.getItemCount(E.ItemId.Tiegao)||0)&&O.reqCheckTiegao();if(o<=0)this.countdown.string="";else{var a=o%60,r=Math.floor(o/60),s=r<10?"0"+r:r,l=a<10?"0"+a:a;this.countdown.string=s+":"+l}}},a.getMineItemNodeX=function(e){return(e-1)*(this.gridSize+this.gridPadding)+this.gridSize/2},a.getMineItemNodeY=function(e){return-(e-1)*(this.gridSize+this.gridPadding)-this.gridSize/2},a.clearSelected=function(){for(var e in this.mineItemComps){if(Object.prototype.hasOwnProperty.call(this.mineItemComps,e))this.mineItemComps[e].clearSelected()}z.trigger(T.MINE_SELECT_NONE)},a.setTouchArea=function(e){var t=this,i=this.checkDiggable(e,this.curDigItemId);this.getShapeNodes(this.curDigItemId,e,this.firstVisibleDepth,this.lastVisibleDepth).forEach((function(n){var o=t.getMineItemComp(e.X+n[0],e.Y+n[1]);o&&(o.clearSelected(),i?o.setGreen():o.setRed())})),z.trigger(i?T.MINE_SELECT_GREEN:T.MINE_SELECT_RED)},a.getShapeNodes=function(e,t,i,n){var o=[];switch(e){case E.ItemId.Tiegao:o=G;break;case E.ItemId.Zhayao:o=R;break;case E.ItemId.Zuantou:for(var a=i;a<=n;a++)o.push([0,a-t.Y]);o.push([-1,n-t.Y]),o.push([1,n-t.Y])}return o},a.getMineItemByPosition=function(e,t){var i=P.mine.Items,n=W.generateMineItemKey(e,t);return i.get(n)},a.onGridsTouchStart=function(e){this.updateTouchGrid(e)},a.onGridsTouchMove=function(e){this.updateTouchGrid(e)},a.onGridsTouchEnd=function(e){this.digByTouch(e)},a.onGridsTouchCancel=function(e){this.clearSelected(),this.clearTouchGrid()},a.onTouchCancel=function(){this.clearSelected(),this.clearTouchGrid()},a.digByTouch=function(e){this.clearSelected(),this.clearTouchGrid();var t=this.getGridPositionByTouch(e,this.tempGridPosition),i=t.x,n=t.y,o=this.getMineItemByPosition(i,n);o&&this.dig(o),this.resetDigItem()},a.clearTouchGrid=function(){this.touchGridX=void 0,this.touchGridY=void 0},a.onEvtDateMine=function(){var e=this;this.lastDiggingTime?this.playDigAnim((function(){e.lastDiggingTime=0,e.updateMineItemNodes(),z.trigger(T.MINE_FINISH_DIG)})):this.updateMineItemNodes()},a.onEvtRecoveryUpdate=function(){this.updateRecovery()},a.onEvtError=function(e){this.lastDiggingTime=0},a.onResMineDig=function(e){e&&(this.rewardData=e.MineRewardData,this.setPopWindowRewardData(this.rewardData))},a.getMineItem=function(e){var t=P.mine.Items;return t?t.get(e):null},a.setPopWindowRewardData=function(e){var t={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var n=e[i],o=this.getMineItem(i);if(!o)continue;if(W.getOreShowType(o)!=E.OreShowType.Box)continue;var a=n[0],r=n[1];if(!a||!r)continue;if(W.isEquipment(a))continue;t[a]||(t[a]=0),t[a]+=r}this.popWindowRewardData=t},a.onResMineGetItem=function(e){if(this.msgMineItem&&e){var t=e.MineReward;t&&(this.rewardData=t,this.setPopWindowRewardData(this.rewardData),this.popRewardWindow(),this.playRewardAnim(this.msgMineItem))}},a.getReward=function(e){return this.rewardData?this.rewardData[W.getMineItemKey(e)]:null},a.getGridPositionByTouch=function(e,t){var i=e.getUILocation(),n=this.gridsNode.getComponent(I).convertToNodeSpaceAR(b(i.x,i.y,0)),o=Math.floor(n.x/this.gridSizeWithPadding)+1,a=Math.floor(-n.y/this.gridSizeWithPadding)+1;return t.x=o,t.y=a,t},a.updateTouchGrid=function(e){var t=this.getGridPositionByTouch(e,this.tempGridPosition),i=t.x,n=t.y;if(this.touchGridX!==i||this.touchGridY!==n){this.touchGridX=i,this.touchGridY=n,this.clearSelected();var o=this.getMineItemByPosition(i,n);o&&this.setTouchArea(o)}},a.dig=function(e){if(this.checkDiggable(e,this.curDigItemId,!0)){if(W.isBlankType(e)&&W.hasReward(e))return this.msgMineItem=e,void O.reqGetItem(e.Y,e.X);var t=Date.now();t-this.lastDiggingTime<E.DigDelta?M.showTip2("当前无法使用"):(this.lastDiggingTime=t,this.msgMineItem=e,this.msgItemId=this.curDigItemId,this.msgFirstDepth=this.firstVisibleDepth,this.msgLastDepth=this.lastVisibleDepth,O.reqOpen(e.Y,e.X,this.curDigItemId))}},a.playDigAnim=function(e){var t=this,i=this.msgMineItem.X,n=this.msgMineItem.Y;switch(this.msgItemId){case E.ItemId.Tiegao:this.playItemDigAnim(E.ItemId.Tiegao,this.msgMineItem,(function(){t.popRewardWindow(),t.playMineItemAnim(t.msgMineItem),e&&e()}));break;case E.ItemId.Zhayao:var o=this.getShapeNodes(this.msgItemId,this.msgMineItem,this.msgFirstDepth,this.msgLastDepth);this.playItemDigAnim(E.ItemId.Zhayao,this.msgMineItem,(function(){t.playZhafeiAnim(t.msgMineItem),t.popRewardWindow(),g.stopAllByTarget(t.zhayaoDigSpine.node);var a=f(t.zhayaoDigSpine.node),r=f(t.zhayaoDigSpine.node),s=f(t.zhayaoDigSpine.node);o.forEach((function(e){var o=e[0],a=e[1],l=i+o,h=n+a,u=t.getMineItemByPosition(l,h);u&&(Math.max(Math.abs(o),Math.abs(a))<=1?r.call((function(){t.playMineItemAnim(u),t.playBoomAnim(u)})):s.call((function(){t.playMineItemAnim(u),t.playBoomAnim(u)})))})),a.sequence(r,f(t.zhayaoDigSpine.node).delay(.1),s,f(t.zhayaoDigSpine.node).call((function(){e&&e()}))).start()}));break;case E.ItemId.Zuantou:this.playItemDigAnim(E.ItemId.Zuantou,this.msgMineItem,(function(){e&&e()}))}},a.playMineItemAnim=function(e){var t=this.lastMineItemData[W.getMineItemKey(e)];t&&t.hp&&(e.HP>0||(this.hideItem(e),this.playItemDispAnim(e),this.playRewardAnim(e)))},a.popRewardWindow=function(){var e=this.popWindowRewardData;e&&(this.popWindowRewardData=null,Object.keys(e).length)},a.playZhafeiAnim=function(e){if(this.zhafeiPfbNode&&p(this.zhafeiPfbNode)){var t=this.getMineItemNodeWorldPos(e);if(t){var i=this.zhafeiPfbNode.parent.getComponent(I).convertToNodeSpaceAR(t),n=this.zhafeiPfbNode.getComponent(v);n&&n.create(i)}}},a.getMineItemNodeWorldPos=function(e){var t=this.getMineItemComp(e);return t?t.getNodeWorldPos():null},a.playItemDispAnim=function(e){var t=this,i=this.getMineItemNodeWorldPos(e);if(i){var n=W.generateMineItemKey(e.X,e.Y),o=this.lastMineItemData[n];switch(o?o.slotType:null){case E.SlotType.Soil:var a=this.generatePoolNode(Et),r=this.itemDispAnimParent.getComponent(I).convertToNodeSpaceAR(i);if(a){a.position=d.ZERO,a.parent=this.itemDispAnimParent;var s=a.getComponent(v);s&&s.create(r),this.scheduleOnce((function(){s&&s.stop(),t.putNodeToPool(Et,a)}),3)}break;case E.SlotType.Stone:var l=this.generatePoolNode(Rt),h=this.itemDispAnimParent.getComponent(I).convertToNodeSpaceAR(i);if(l){l.position=d.ZERO,l.parent=this.itemDispAnimParent;var u=l.getComponent(v);u&&u.create(h),this.scheduleOnce((function(){u&&u.stop(),t.putNodeToPool(Rt,l)}),3)}}}},a.playBoomAnim=function(e){var t=this,i=W.generateMineItemKey(e.X,e.Y),n=this.lastMineItemData[i],o=n?n.slotType:null,a=n?n.boxId:0;if(o==E.SlotType.Blank&&0==a)return!1;var r=this.getMineItemNodeWorldPos(e);if(r){var s=this.generatePoolNode(Wt),l=this.boomAnimParent.getComponent(I).convertToNodeSpaceAR(r);if(s){s.position=l,s.parent=this.boomAnimParent;var h=s.getComponent(u.Skeleton);h&&(s.active=!0,h.setCompleteListener((function(){s.active=!1,t.putNodeToPool(Wt,s)})),h.setAnimation(0,"skill",!1))}}},a.playItemDigAnim=function(e,t,i){var n=this,o=this.getMineItemNodeWorldPos(t);if(o)switch(e){case E.ItemId.Tiegao:var a=this.tiegaoDigSpine.node.parent.getComponent(I).convertToNodeSpaceAR(o);this.tiegaoDigSpine.node.position=a,this.tiegaoDigSpine.setCompleteListener((function(){n.tiegaoDigSpine.node.active=!1})),this.tiegaoDigSpine.node.active=!0,this.tiegaoDigSpine.setAnimation(0,"skill",!1),i&&i(),N.playEffect("sounds/tiegao");break;case E.ItemId.Zhayao:var r=this.zhayaoDigSpine.node.parent.getComponent(I).convertToNodeSpaceAR(o);this.zhayaoDigSpine.node.position=r,this.zhayaoDigSpine.node.active=!0,this.zhayaoDigSpine.setCompleteListener((function(){n.zhayaoDigSpine.node.active=!1})),this.zhayaoDigSpine.setEventListener((function(e,t){"hit"==t.data.name&&i&&i()})),this.zhayaoDigSpine.setAnimation(0,"skill",!1),N.playEffect("sounds/zhayao");break;case E.ItemId.Zuantou:var s=this.gridsNode.getComponent(I).convertToWorldSpaceAR(d.ZERO),l=this.zuantouDigNode.parent.getComponent(I).convertToNodeSpaceAR(s);this.zuantouDigNode.active=!0;var h=l.x+this.getMineItemNodeX(t.X);this.zuantouDigNode.setPosition(h,100,0),g.stopAllByTarget(this.zuantouDigNode);for(var u=f(this.zuantouDigNode),m=function(e){var i=100-(e-n.firstVisibleDepth+1)*n.gridSizeWithPadding;u.to(.12,{position:new d(h,i,0)}),u.call((function(){var i=n.getMineItemByPosition(t.X,e);if(i)if(e==n.lastVisibleDepth){var o=n.getMineItemByPosition(i.X-1,i.Y),a=n.getMineItemByPosition(i.X+1,i.Y);n.playMineItemAnim(i),n.playBoomAnim(i),n.playZhafeiAnim(i),o&&(n.playMineItemAnim(o),n.playBoomAnim(o)),a&&(n.playMineItemAnim(a),n.playBoomAnim(a)),n.popRewardWindow()}else n.playMineItemAnim(i),n.playBoomAnim(i)}))},c=this.firstVisibleDepth;c<=this.lastVisibleDepth;c++)m(c);u.call((function(){n.zuantouDigNode.active=!1,i&&i()})).start(),N.playEffect("sounds/zuantou")}},a.playRewardAnim=function(e){var t=this,i=this.getReward(e);if(i){var n=i[0]||i.ItemId,o=i[1]||i.Count;if(n){var a=this.getMineItemComp(e);if(a){var r=a.getNodeWorldPos(),s=this.getNodeFromPool(Gt);if(s){s.parent=this.rewardTipsAnimParent;var l=s.getComponent("mine_reward_tips");if(l){var h=0,u=0;n==E.ItemId.Lingshi&&this.lingshiAddition?(h=o*this.lingshiAddition/(this.lingshiAddition+1),u=o-(h=Math.floor(parseFloat(h.toFixed(0))))):u=o,l.playAnimInWorldPos(n,u,h,r,(function(){t.putNodeToPool(Gt,s)}))}}var m=W.isEquipment(n),c=W.getOreShowType(e);if(c==E.OreShowType.Pile||c==E.OreShowType.Num||c==E.OreShowType.Box&&m){var p=this.getNodeFromPool(Ot);if(p){p.parent=this.flyAnimParent;var g=p.getComponent("fly_anim");if(g){var f=this.flyPos[n]||this.leftCorner.getComponent(I).convertToWorldSpaceAR(d.ZERO),b=c==E.OreShowType.Pile?y.Big:y.Concrete;g.playWithScale(b,n,o,r,f,this.flyScale,null,(function(){t.putNodeToPool(Ot,p)}))}}}}}}},a.getMineItemComp=function(e,t){return"number"==typeof e?this.mineItemComps[W.generateMineItemKey(e,t)]:this.mineItemComps[W.getMineItemKey(e)]},a.hideItem=function(e){var t=this.getMineItemComp(e);t&&t.hideMineItemNode()},a.checkDiggable=function(e,t,i){if(void 0===i&&(i=!1),1!==e.Bright)return i&&M.showTip2("未点亮"),!1;var n=e.SlotType==E.SlotType.Blank;if(n&&W.hasReward(e))return!0;if(!((_.getItemCount(t)||0)<=0)){if(t==E.ItemId.Tiegao){if(n)return i&&M.showTip2("需要点击非空地"),!1}else if((t==E.ItemId.Zhayao||t==E.ItemId.Zuantou)&&!n)return i&&M.showTip2("需要点击空地"),!1;return!0}i&&M.showTip2("道具不足")},a.getMineBlockGuideTarget=function(e){var t=this.getMineItemComp(e.x,e.depth);return t?t.node:null},a.onWillClose=function(){this.gridsInited=!1,z.trigger(T.MINE_CLOSE_WINDOW)},t}(U)).resourceFile="prefab/hall/mine/mine_main_window",Ve=t((Ge=zt).prototype,"rewardTipsPrefab",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Oe=t(Ge.prototype,"soilDispPfb",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),We=t(Ge.prototype,"stoneDispPfb",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xe=t(Ge.prototype,"toInstBg",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Le=t(Ge.prototype,"toInstStoneBg",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ue=t(Ge.prototype,"toInstSelect",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Fe=t(Ge.prototype,"toInstFly",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ze=t(Ge.prototype,"toInstBoom",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ye=t(Ge.prototype,"moveBgNode",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xe=t(Ge.prototype,"moveBgSubNodes",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),He=t(Ge.prototype,"mineArea",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ke=t(Ge.prototype,"gridsNode",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),qe=t(Ge.prototype,"gridsShakeNode",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),je=t(Ge.prototype,"moveAnimDownNode",[ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Je=t(Ge.prototype,"moveAnimUpNode",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qe=t(Ge.prototype,"soilBgParent",[oe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$e=t(Ge.prototype,"stoneBgParent",[ae],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),et=t(Ge.prototype,"selectPrent",[re],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tt=t(Ge.prototype,"depthLbl",[se],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),it=t(Ge.prototype,"leftGear",[le],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),nt=t(Ge.prototype,"rightGear",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ot=t(Ge.prototype,"itemDispAnimParent",[ue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),at=t(Ge.prototype,"boomAnimParent",[me],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),rt=t(Ge.prototype,"zhafei",[de],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),st=t(Ge.prototype,"rewardTipsAnimParent",[ce],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),lt=t(Ge.prototype,"tiegaoDigSpine",[pe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ht=t(Ge.prototype,"zhayaoDigSpine",[ge],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ut=t(Ge.prototype,"zuantouDigNode",[fe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mt=t(Ge.prototype,"flyAnimParent",[Ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),dt=t(Ge.prototype,"coinItemView",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ct=t(Ge.prototype,"coinIconNode",[ye],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pt=t(Ge.prototype,"diamondItemView",[ve],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gt=t(Ge.prototype,"diamondIconNode",[we],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ft=t(Ge.prototype,"tiegaoTopItemView",[Pe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),It=t(Ge.prototype,"lingshiItemView",[De],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),bt=t(Ge.prototype,"lingshiIconNode",[Ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),yt=t(Ge.prototype,"zuantouItemView",[Te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),vt=t(Ge.prototype,"zuantouIconNode",[Me],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),wt=t(Ge.prototype,"zhayaoItemView",[Se],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pt=t(Ge.prototype,"zhayaoIconNode",[Ae],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Dt=t(Ge.prototype,"tiegaoBottomItemView",[ze],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nt=t(Ge.prototype,"tiegaoIconNode",[Ce],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Tt=t(Ge.prototype,"countdown",[ke],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Mt=t(Ge.prototype,"workerDown",[_e],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),St=t(Ge.prototype,"workerUp",[Be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),At=t(Ge.prototype,"leftCorner",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Re=Ge))||Re));a._RF.pop()}}}));

System.register("chunks:///_virtual/mine_message.ts",["cc","./message_manager.ts"],(function(e){"use strict";var n,t,a;return{setters:[function(e){n=e.cclegacy},function(e){t=e.MessageManager,a=e.ClientProtocols}],execute:function(){n._RF.push({},"fd482Q1Y1lOYqlSclrtbWf0","mine_message",void 0);e("MineMessage",function(){function e(){}return e.reqCheckTiegao=function(){t.request(a.MineCheckTieGao)},e.reqOpen=function(e,n,s){var i={Deep:parseInt(e),X:parseInt(n),ItemType:s};t.request(a.MineDig,i)},e.reqGetItem=function(e,n){var s={Deep:parseInt(e),X:parseInt(n)};t.request(a.MineGetItem,s)},e}()),e("ReqMsgData",{MineOpen:{protoId:5e3,className:"MineOpen",response:["GameMineData","cdLeft","cd","TieGaoMax"]},MineDig:{protoId:5001,className:"MineDig",param:["Deep","X","ItemType"],response:["GameMineData","cdLeft","cd","MineRewardData"]},MineGetItem:{protoId:5002,className:"MineGetItem",param:["Deep","X"],response:["MineItem","MineReward"]},MineCheckTieGao:{protoId:5003,className:"MineCheckTieGao",response:["cdLeft","cd","TieGaoMax"]}});n._RF.pop()}}}));

System.register("chunks:///_virtual/mine_reward_item.ts",["./rollupPluginModLoBabelHelpers.js","cc","./node_decorator.ts","./global_functions.ts"],(function(e){"use strict";var t,n,i,r,o,a,c,l,u,s,p;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,c=e.Component,l=e.Sprite,u=e.Label},function(e){s=e.ncg},function(e){p=e.GF}],execute:function(){var m,f,h,d,y,b;o._RF.push({},"21707ed+0tKaa5MJrJFab1R","mine_reward_item",void 0);var g=a.ccclass;a.property,e("MineRewardItem",(m=s({path:"icon",type:l}),f=s({path:"num",type:u}),g((y=t((d=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,i(t,"icon",y,r(t)),i(t,"num",b,r(t)),t}return n(t,e),t.prototype.updateItem=function(e,t){this.icon.spriteFrame=null,p.setTexture(this.icon,p.getLocalItemPath(e)),this.num.string="X"+t},t}(c)).prototype,"icon",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=t(d.prototype,"num",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=d))||h));o._RF.pop()}}}));

System.register("chunks:///_virtual/mine_reward_tips.ts",["./rollupPluginModLoBabelHelpers.js","cc","./global_functions.ts"],(function(e){"use strict";var i,t,n,r,o,a,l,c,u,s,p,d,m,f,_;return{setters:[function(e){i=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,l=e.Node,c=e.Sprite,u=e.Label,s=e.UITransform,p=e.Tween,d=e.tween,m=e.v3,f=e.Component},function(e){_=e.GF}],execute:function(){var b,h,y,w,g,v,z,T,k,A,I,L;o._RF.push({},"fa9ffy1k0JPqJaWILYcnEyK","mine_reward_tips",void 0);var P=a.ccclass,F=a.property;e("MineRewardTips",(b=F(l),h=F(l),y=F(c),w=F(u),g=F(u),P((T=i((z=function(e){function i(){for(var i,t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return(i=e.call.apply(e,[this].concat(o))||this).callback=void 0,n(i,"win_node",T,r(i)),n(i,"item",k,r(i)),n(i,"item_icon",A,r(i)),n(i,"item_num",I,r(i)),n(i,"item_add",L,r(i)),i}t(i,e);var o=i.prototype;return o.playAnimInWorldPos=function(e,i,t,n,r){this.callback=r,_.setTexture(this.item_icon,_.getLocalItemPath(e)),this.item_num.string="+"+i,t?(this.item_add.string="+"+t,this.item_add.node.active=!0):this.item_add.node.active=!1;var o=this.win_node.parent.getComponent(s).convertToNodeSpaceAR(n);this.win_node.position=o,p.stopAllByTarget(this.win_node),d(this.win_node).delay(.1).by(1,{position:m(0,90,0)}).call((function(){r&&r()})).start()},o.onAnimFinished=function(){this.callback&&this.callback()},i}(f)).prototype,"win_node",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=i(z.prototype,"item",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=i(z.prototype,"item_icon",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=i(z.prototype,"item_num",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=i(z.prototype,"item_add",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=z))||v));o._RF.pop()}}}));

System.register("chunks:///_virtual/mine_reward_window.ts",["./rollupPluginModLoBabelHelpers.js","cc","./gravity_comp.ts","./global_functions.ts","./PanelBase.ts"],(function(t){"use strict";var e,n,i,r,o,a,l,c,u,s,f,h,p,m;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){o=t.cclegacy,a=t._decorator,l=t.Node,c=t.tween,u=t.v3,s=t.UITransform,f=t.Vec3},function(t){h=t.default},function(t){p=t.GF},function(t){m=t.default}],execute:function(){var w,d,g,b,v,y,I,_,z,C,Y,F,P,R,S;o._RF.push({},"424dfFGq5xKfZL5YpRfnESQ","mine_reward_window",void 0);var k=a.ccclass,E=a.property;t("MineRewardWindow",(w=E(l),d=E(l),g=E(l),b=E(l),v=E(l),y=E(l),k(((S=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))||this).mask=204,i(e,"windowNode",z,r(e)),i(e,"toInstItem",C,r(e)),i(e,"content",Y,r(e)),i(e,"light",F,r(e)),i(e,"leftYanhua",P,r(e)),i(e,"rightYanhua",R,r(e)),e}n(e,t);var o=e.prototype;return o.onClickOk=function(){this.closeSelf()},o.onSetData=function(t){var e=this;this.windowNode.setScale(.6,.6,.6),c(this.windowNode).to(.2,{scale:u(1,1,1)}).call((function(){e.showUI(t),e.playGravityCompAnim()})).start()},o.showUI=function(t){var e=this,n=t?t.rewards:null;if(n){var i=this.content.getComponent(s),r=this.toInstItem.getComponent(s),o=i.width,a=i.height,l=r.width,u=r.height,f=Object.keys(n),h=f.length;if(1==h){var p=f[0],m=n[p];this.createItem(p,m).setPosition(0,-a/2,0)}else if(h<=4){var w=(o-l*h-25*(h-1))/2-o/2+l/2;f.forEach((function(t,i){var r=n[t];e.createItem(t,r).setPosition(w+(l+25)*i,-a/2,0)}))}else{var d=-o/2+l/2,g=-u/2;f.forEach((function(t,i){var r=n[t],o=i%4,a=Math.ceil((i+1)/4)-1;e.createItem(t,r).setPosition(d+(l+25)*o,g-(u+25)*a,0)}))}}c(this.light).by(2,{angle:360}).repeatForever().start()},o.createItem=function(t,e){var n=p.instantiate(this.toInstItem);return p.addScriptComponent(n,"mine_reward_item").updateItem(t,e),n.parent=this.content,n.active=!0,n},o.playGravityCompAnim=function(){var t=this.leftYanhua.getComponent(h);t&&t.create(f.ZERO),(t=this.rightYanhua.getComponent(h))&&t.create(f.ZERO)},e}(m)).resourceFile="prefab/hall/mine/mine_reward_window",z=e((_=S).prototype,"windowNode",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=e(_.prototype,"toInstItem",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=e(_.prototype,"content",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(_.prototype,"light",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=e(_.prototype,"leftYanhua",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(_.prototype,"rightYanhua",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=_))||I));o._RF.pop()}}}));

System.register("chunks:///_virtual/mine_tiegao_recovery_comp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./game_event.ts","./notifier_center.ts"],(function(e){"use strict";var t,r,c,o,n,i,u;return{setters:[function(e){t=e.inheritsLoose},function(e){r=e.cclegacy,c=e._decorator,o=e.macro,n=e.Component},function(e){i=e.GameEventType},function(e){u=e.Notifier}],execute:function(){var s;r._RF.push({},"0561bvgWGpH1JzA3mQRkWqv","mine_tiegao_recovery_comp",void 0);var l=c.ccclass;e("MineTiegaoRecoveryComp",l(s=function(e){function r(){return e.apply(this,arguments)||this}t(r,e);var c=r.prototype;return c.init=function(){this.setRecoverySchedule(),this.recoveryScheduleHandler()},c.setRecoverySchedule=function(){this.removeRecoverySchedule(),this.schedule(this.recoveryScheduleHandler,1,o.REPEAT_FOREVER)},c.removeRecoverySchedule=function(){this.unschedule(this.recoveryScheduleHandler)},c.recoveryScheduleHandler=function(){u.trigger(i.MINE_RECOVERY_UPDATE)},r}(n))||s);r._RF.pop()}}}));

System.register("chunks:///_virtual/mine_utils.ts",["cc","./GameData.ts","./mine_const.ts","./LocalConfig.ts","./ConfigLoader.ts"],(function(e){"use strict";var n,t,i,o,r,u,c;return{setters:[function(e){n=e.cclegacy,t=e.UITransform,i=e.Vec3},function(e){o=e.GD},function(e){r=e.MineConst},function(e){u=e.LocalConfig},function(e){c=e.ConfigPath}],execute:function(){n._RF.push({},"42703PCGwtKYIi90xbMy/Rt","mine_utils",void 0);e("default",function(){function e(){}return e.generateMineItemKey=function(e,n){return 256*n+e},e.isBright=function(e){return 1===e.Bright},e.isStoneType=function(e){return!(!e||e.SlotType!=r.SlotType.Stone)},e.isBlankType=function(e){return!(!e||e.SlotType!=r.SlotType.Blank)},e.hasReward=function(e){return!(!e||!e.BoxId)},e.getMineItemByPosition=function(n,t){var i=o.mine.Items,r=e.generateMineItemKey(n,t);return i.get(r)},e.isDigged=function(e){return!(!e||0!=e.OreType)},e.getMineItemKey=function(n){if(n)return e.generateMineItemKey(n.X,n.Y)},e.getRoomIconPath=function(e){return""+r.MineItemPath+e},e.isEquipment=function(e){return!1},e.getNodeWorldPos=function(e){return e.getComponent(t).convertToWorldSpaceAR(i.ZERO)},e.getOreShowType=function(e){if(e){var n=e.OreType;if(0!=n){var t=u.getCfgByObjId(c.MineOreConfig,n);if(t)return t.showType}}},e.makeItemIdNumMap=function(e){if(e){var n={};for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var i=e[t],o=i[0],r=i[1];if(!o||!r)continue;n[o]||(n[o]=0),n[o]+=r}return n}},e}());n._RF.pop()}}}));

System.register("chunks:///_virtual/modules",["./common_item_view.ts","./mine_common_item_view.ts","./mine_const.ts","./mine_help_window.ts","./mine_item_comp.ts","./mine_item_tiegao_view.ts","./mine_main_window.ts","./mine_message.ts","./mine_reward_item.ts","./mine_reward_tips.ts","./mine_reward_window.ts","./mine_tiegao_recovery_comp.ts","./mine_utils.ts","./gamedata_mine.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/modules', 'chunks:///_virtual/modules'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});